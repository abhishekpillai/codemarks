<% if params[:url] %>
  $(function() {
    $("#url_form input[type=submit]").hide();
    $("<%= escape_javascript(render('codemarks/form')) %>").hide()
      .appendTo($('#link_form_container'))
      .slideDown(200);


    $("#url_form, #new_codemark").keyup(function(e) {
      if (e.keyCode == 13) {
        e.preventDefault();
      }
    });

    $(document).keyup(function(e) {
      if (e.keyCode == 27) {
        $('#link_form_container').html("<%= escape_javascript(render('/shared/build_link_form')) %>");
        $("#link_form_container").removeClass("highlighted");
      }
    });

    var topics_count = $("#topic_tags li").length;
    if(topics_count == 0) {
      $("#save_codemark").attr('disabled', 'disabled');
    }
   
    $("#link_form_container").addClass("highlighted");

  });



<% else %>
  $('#link_form_container').html("<%= escape_javascript(render('first_form')) %>");
<% end %>

prepareAutocompletes();
prepareTagDeletes();

